# 查询直播播放在线人数<a name="live_03_0016"></a>

## 功能介绍<a name="section1874674311363"></a>

查询加速的直播播放在线人数

## 调试<a name="section974794314361"></a>

您可以在[API Explorer](https://apiexplorer.developer.huaweicloud.com/apiexplorer/doc?product=Live&api=ShowOnlineUsers)中调试该接口。

## URI<a name="section47483431366"></a>

GET /v1/\{project\_id\}/stream/users

**表 1**  路径参数

<a name="table197491443103618"></a>
<table><thead align="left"><tr id="row197491343113617"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.5.1.1"><p id="p775024317361"><a name="p775024317361"></a><a name="p775024317361"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="10%" id="mcps1.2.5.1.2"><p id="p975014317361"><a name="p975014317361"></a><a name="p975014317361"></a>是否必选</p>
</th>
<th class="cellrowborder" valign="top" width="20%" id="mcps1.2.5.1.3"><p id="p0750243203615"><a name="p0750243203615"></a><a name="p0750243203615"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.2.5.1.4"><p id="p57512436364"><a name="p57512436364"></a><a name="p57512436364"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row13749174373616"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p11751184316363"><a name="p11751184316363"></a><a name="p11751184316363"></a>project_id</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p87521435365"><a name="p87521435365"></a><a name="p87521435365"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p1575218435362"><a name="p1575218435362"></a><a name="p1575218435362"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p9753174312369"><a name="p9753174312369"></a><a name="p9753174312369"></a>项目ID，获取方法请参考<a href="https://support.huaweicloud.com/api-live/live_03_0023.html" target="_blank" rel="noopener noreferrer">获取项目ID</a>。</p>
</td>
</tr>
</tbody>
</table>

**表 2**  Query参数

<a name="table4754124310360"></a>
<table><thead align="left"><tr id="row175314313614"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.5.1.1"><p id="p1375494320362"><a name="p1375494320362"></a><a name="p1375494320362"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="10%" id="mcps1.2.5.1.2"><p id="p57559432364"><a name="p57559432364"></a><a name="p57559432364"></a>是否必选</p>
</th>
<th class="cellrowborder" valign="top" width="20%" id="mcps1.2.5.1.3"><p id="p14755243193617"><a name="p14755243193617"></a><a name="p14755243193617"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.2.5.1.4"><p id="p1775564363618"><a name="p1775564363618"></a><a name="p1775564363618"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row67532043193611"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p147561843123616"><a name="p147561843123616"></a><a name="p147561843123616"></a>domain</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p0756104315366"><a name="p0756104315366"></a><a name="p0756104315366"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p1875744315369"><a name="p1875744315369"></a><a name="p1875744315369"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p6757144333610"><a name="p6757144333610"></a><a name="p6757144333610"></a>直播播放域名</p>
</td>
</tr>
<tr id="row1475434319367"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p17758843173616"><a name="p17758843173616"></a><a name="p17758843173616"></a>app_name</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p87581943103612"><a name="p87581943103612"></a><a name="p87581943103612"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p57581343103619"><a name="p57581343103619"></a><a name="p57581343103619"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p77591743103613"><a name="p77591743103613"></a><a name="p77591743103613"></a>应用名称。</p>
</td>
</tr>
<tr id="row6754134312364"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p16759104310361"><a name="p16759104310361"></a><a name="p16759104310361"></a>stream_name</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p147601843193611"><a name="p147601843193611"></a><a name="p147601843193611"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p976016436368"><a name="p976016436368"></a><a name="p976016436368"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p77601243133620"><a name="p77601243133620"></a><a name="p77601243133620"></a>流名称</p>
</td>
</tr>
<tr id="row5754104312363"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p97611043173617"><a name="p97611043173617"></a><a name="p97611043173617"></a>start_time</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p576114343616"><a name="p576114343616"></a><a name="p576114343616"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p1676234316367"><a name="p1676234316367"></a><a name="p1676234316367"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p13762184353618"><a name="p13762184353618"></a><a name="p13762184353618"></a>查询开始时间，UTC时间，格式：yyyy-mm-ddThh:mm:ssZ。无开始时间表示查询最近统计周期在线人数数据</p>
</td>
</tr>
<tr id="row15754134353617"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p3762134318367"><a name="p3762134318367"></a><a name="p3762134318367"></a>end_time</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p1476344313363"><a name="p1476344313363"></a><a name="p1476344313363"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p197631143153617"><a name="p197631143153617"></a><a name="p197631143153617"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p15764144393620"><a name="p15764144393620"></a><a name="p15764144393620"></a>查询结束时间，UTC时间，格式：yyyy-MM-ddTHH:mm:ssZ。</p>
<a name="ul1176414313364"></a><a name="ul1176414313364"></a><ul id="ul1176414313364"><li>start_time与end_time均不存在时，服务端从最近一个统计周期的数据里查询。</li><li>start_time存在、end_time不存在时，end_time取当前时间。</li><li>start_time不存在、end_time存在时，请求非法。</li><li>只能查询最近三个月内的数据，start_time和end_time的跨度不能大于30天。</li></ul>
</td>
</tr>
<tr id="row8754124311366"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p1676674316365"><a name="p1676674316365"></a><a name="p1676674316365"></a>step</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p47661943163619"><a name="p47661943163619"></a><a name="p47661943163619"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p18767143123612"><a name="p18767143123612"></a><a name="p18767143123612"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p117671643143617"><a name="p117671643143617"></a><a name="p117671643143617"></a>统计周期。 单位：分钟</p>
</td>
</tr>
</tbody>
</table>

## 请求参数<a name="section1476734373619"></a>

**表 3**  请求Header参数

<a name="HeaderParameter"></a>
<table><thead align="left"><tr id="row17768643173611"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.5.1.1"><p id="p1776964312369"><a name="p1776964312369"></a><a name="p1776964312369"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="10%" id="mcps1.2.5.1.2"><p id="p27691443173611"><a name="p27691443173611"></a><a name="p27691443173611"></a>是否必选</p>
</th>
<th class="cellrowborder" valign="top" width="20%" id="mcps1.2.5.1.3"><p id="p157705434360"><a name="p157705434360"></a><a name="p157705434360"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.2.5.1.4"><p id="p6770184383613"><a name="p6770184383613"></a><a name="p6770184383613"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row97681243133614"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.1 "><p id="p67709430365"><a name="p67709430365"></a><a name="p67709430365"></a>X-Auth-Token</p>
</td>
<td class="cellrowborder" valign="top" width="10%" headers="mcps1.2.5.1.2 "><p id="p377118433365"><a name="p377118433365"></a><a name="p377118433365"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.5.1.3 "><p id="p277114373616"><a name="p277114373616"></a><a name="p277114373616"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.5.1.4 "><p id="p20772154333613"><a name="p20772154333613"></a><a name="p20772154333613"></a>用户Token。 通过调用IAM服务获取用户Token接口获取（响应消息头中X-Subject-Token的值）。</p>
</td>
</tr>
</tbody>
</table>

## 响应参数<a name="section17772124363612"></a>

**状态码为 200 时:**

**表 4**  响应Body参数

<a name="responseParameter"></a>
<table><thead align="left"><tr id="row1077314313610"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.4.1.1"><p id="p277444393613"><a name="p277444393613"></a><a name="p277444393613"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="20%" id="mcps1.2.4.1.2"><p id="p1777414439362"><a name="p1777414439362"></a><a name="p1777414439362"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="60%" id="mcps1.2.4.1.3"><p id="p187747434362"><a name="p187747434362"></a><a name="p187747434362"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row2773164373613"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.1 "><p id="p7775114318369"><a name="p7775114318369"></a><a name="p7775114318369"></a>total</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.2 "><p id="p677520432367"><a name="p677520432367"></a><a name="p677520432367"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.2.4.1.3 "><p id="p10776164316363"><a name="p10776164316363"></a><a name="p10776164316363"></a>查询结果的总元素数量</p>
</td>
</tr>
<tr id="row977312434367"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.1 "><p id="p777614373618"><a name="p777614373618"></a><a name="p777614373618"></a>user_info</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.2 "><p id="p1377794317366"><a name="p1377794317366"></a><a name="p1377794317366"></a>Array of <a href="#response_UserInfo">UserInfo</a> objects</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.2.4.1.3 "><p id="p677794393612"><a name="p677794393612"></a><a name="p677794393612"></a>正在推流的音视频信息</p>
</td>
</tr>
</tbody>
</table>

**表 5**  UserInfo

<a name="response_UserInfo"></a>
<table><thead align="left"><tr id="row47782043173614"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.4.1.1"><p id="p17781443193618"><a name="p17781443193618"></a><a name="p17781443193618"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="20%" id="mcps1.2.4.1.2"><p id="p57794437364"><a name="p57794437364"></a><a name="p57794437364"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="60%" id="mcps1.2.4.1.3"><p id="p77791143103613"><a name="p77791143103613"></a><a name="p77791143103613"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row1577874319364"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.1 "><p id="p578011435362"><a name="p578011435362"></a><a name="p578011435362"></a>user_num</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.2 "><p id="p2780124312361"><a name="p2780124312361"></a><a name="p2780124312361"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.2.4.1.3 "><p id="p167801543123617"><a name="p167801543123617"></a><a name="p167801543123617"></a>直播流的在线人数</p>
</td>
</tr>
<tr id="row1977854312369"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.1 "><p id="p5781164319366"><a name="p5781164319366"></a><a name="p5781164319366"></a>timestamp</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.2 "><p id="p3781124316369"><a name="p3781124316369"></a><a name="p3781124316369"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.2.4.1.3 "><p id="p1278254393610"><a name="p1278254393610"></a><a name="p1278254393610"></a>操作执行的时间，UTC时间，格式：yyyy-MM-ddTHH:mm:ssZ</p>
</td>
</tr>
</tbody>
</table>

**状态码为 400 时:**

**表 6**  响应Body参数

<a name="table1078234312363"></a>
<table><thead align="left"><tr id="row1578254314369"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.4.1.1"><p id="p1978374313611"><a name="p1978374313611"></a><a name="p1978374313611"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="20%" id="mcps1.2.4.1.2"><p id="p878374373617"><a name="p878374373617"></a><a name="p878374373617"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="60%" id="mcps1.2.4.1.3"><p id="p16784124333615"><a name="p16784124333615"></a><a name="p16784124333615"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row478244343618"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.1 "><p id="p157849439363"><a name="p157849439363"></a><a name="p157849439363"></a>error_code</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.2 "><p id="p137862043193611"><a name="p137862043193611"></a><a name="p137862043193611"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.2.4.1.3 "><p id="p478614431367"><a name="p478614431367"></a><a name="p478614431367"></a>错误码</p>
</td>
</tr>
<tr id="row37821743133616"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.1 "><p id="p18787194373616"><a name="p18787194373616"></a><a name="p18787194373616"></a>error_msg</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.4.1.2 "><p id="p6787194333614"><a name="p6787194333614"></a><a name="p6787194333614"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.2.4.1.3 "><p id="p6788643203619"><a name="p6788643203619"></a><a name="p6788643203619"></a>错误描述</p>
</td>
</tr>
</tbody>
</table>

## 请求示例<a name="section178854343618"></a>

```
GET https://{endpoint}/v1/{project_id}/stream/users?domain=play.example.huawei.com&app_name=live&stream_name=xxx
```

## 响应示例<a name="section117891343203618"></a>

**状态码为 200 时:**

查询直播播放在线人数成功

```
{
  "total" : 1,
  "user_info" : [ {
    "user_num" : 1024,
    "timestamp" : "2018-05-19T21:10:15Z"
  } ]
}
```

**状态码为 400 时:**

查询直播播放在线人数失败

```
{
  "error_code" : "LIVE.100011001",
  "error_msg" : "Request Illegal"
}
```

## 状态码<a name="section6795154310361"></a>

<a name="table2068"></a>
<table><thead align="left"><tr id="row1379744383610"><th class="cellrowborder" valign="top" width="15%" id="mcps1.1.3.1.1"><p id="p7797243183616"><a name="p7797243183616"></a><a name="p7797243183616"></a>状态码</p>
</th>
<th class="cellrowborder" valign="top" width="85%" id="mcps1.1.3.1.2"><p id="p779719431366"><a name="p779719431366"></a><a name="p779719431366"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row3797194317362"><td class="cellrowborder" valign="top" width="15%" headers="mcps1.1.3.1.1 "><p id="p1079810431369"><a name="p1079810431369"></a><a name="p1079810431369"></a>200</p>
</td>
<td class="cellrowborder" valign="top" width="85%" headers="mcps1.1.3.1.2 "><p id="p2079824363613"><a name="p2079824363613"></a><a name="p2079824363613"></a>查询直播播放在线人数成功</p>
</td>
</tr>
<tr id="row27975438365"><td class="cellrowborder" valign="top" width="15%" headers="mcps1.1.3.1.1 "><p id="p197992434369"><a name="p197992434369"></a><a name="p197992434369"></a>400</p>
</td>
<td class="cellrowborder" valign="top" width="85%" headers="mcps1.1.3.1.2 "><p id="p17991343193612"><a name="p17991343193612"></a><a name="p17991343193612"></a>查询直播播放在线人数失败</p>
</td>
</tr>
</tbody>
</table>

## 错误码<a name="section38007430365"></a>

请参见[错误码](错误码.md)。

